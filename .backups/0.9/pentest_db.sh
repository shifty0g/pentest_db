#!/bin/bash
LAST_UPDATED="17/09/21"
#
# TO DO
#==============
# - more filter options. make the commnads output work - getting extrachacrters in them
# - get it so the nice table view - does the search fist maybe then builds csv to parse 
# - need to make a clear all filters on excel
# - consistancy - clean up variables and have a clear defintion
#
#
#
#

export COMMANDSDB="/mnt/hgfs/Share/Mega/my_scripts/pentest_db/database.xlsx"
export COMMANDSCSV="/tmp/database.csv"

function commands-install () {
pip install xlsx2csv
sudo apt install -y csvkit
}
function commands-export () {
xlsx2csv -i -q all $COMMANDSDB $COMMANDSCSV
}
function commands-full () {
commands-export
	cat $COMMANDSCSV | head -1 > /tmp/database2.csv
if [ ! -z $1 ]; then 
	cat $COMMANDSCSV | grep -i $1 | sort -u >> /tmp/database2.csv
else 
	cat $COMMANDSCSV | sort -u >> /tmp/database2.csv
fi
csvlook --snifflimit 0 /tmp/database2.csv --max-column-width 90

}
function commands-tools () {
commands-export
csvcut -x -c 2,7 $COMMANDSCSV | head -1 > /tmp/database2.csv
if [ ! -z $1 ]; then 
	csvcut -x -c 2,7 $COMMANDSCSV | grep -i $1 | sort -u >> /tmp/database2.csv

else 
	csvcut -x -c 2,7 $COMMANDSCSV | sort -u >> /tmp/database2.csv

fi
csvlook --snifflimit 0 /tmp/database2.csv --max-column-width 180


}
function commands () {
commands-export 
if [ ! -z $1 ]; then 
	cat $COMMANDSCSV | cut -d, -f7- | grep -v Command | sed "s/^\"//;s/\"$//" | sed 's/""/"/g' | sort -u | grep -i $1
else 
	cat $COMMANDSCSV | cut -d, -f7- | grep -v Command | sed "s/^\"//;s/\"$//" | sed 's/""/"/g' | sort -u 
fi
}

# commands-tools . just prints tools ,dec + commands 